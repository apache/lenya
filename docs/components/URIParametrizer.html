<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>URI Parametrizer</title>
<link type="text/css" href="../../skin/page.css" rel="stylesheet">
</head>
<body text="#000000" bgcolor="#FFFFFF">
<!--================= start Banner ==================-->
<table summary="header with logos" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<!--================= start Group Logo ==================-->
<td valign="bottom" bgcolor="#FFFFFF">
<div class="headerlogo">
<a href="http://cocoon.apache.org"><img border="0" class="logoImage" alt="Apache Cocoon" src="../../images/cocoon-project-logo-big.png"></a>
</div>
<span class="textheader">Apache Cocoon</span>
<!--================= start Tabs ==================-->
<div class="tab">
<table summary="tab bar" border="0" cellpadding="0" cellspacing="0">
<tr>
<td width="10" valign="bottom">
<div class="tab-separator">
<img alt="" width="10" src="../../skin/images/spacer.gif"></div>
</td><td valign="bottom" class="tab">
<div class="tab-separator">
<table cellspacing="0" cellpadding="0" border="0">
<tr>
<td style="background-image: url(../../skin/images/tab-left.png)" valign="top" width="5" height="5"><img alt="" src="../../skin/images/tab-corner-left.png"></td><td rowspan="2" valign="bottom" class="tab">
<div class="tab-not-selected-shadow">
<div class="tab-not-selected">
<a href="../../project/index.html"><font face="Arial, Helvetica, Sans-serif">Project Information</font></a>
</div>
</div>
</td><td style="background-image: url(../../skin/images/tab-right.png)" valign="top" width="5" height="5"><img alt="" src="../../skin/images/tab-corner-right.png"></td>
</tr>
<tr>
<td style="background-image: url(../../skin/images/tab-left.png)" valign="bottom">
<div class="tab-not-selected-shadow-left">
<img alt="" width="4" src="../../skin/images/spacer.gif"></div>
</td><td style="background-image: url(../../skin/images/tab-right.png)" valign="bottom">
<div class="tab-not-selected-shadow-right">
<img alt="" width="4" src="../../skin/images/spacer.gif"></div>
</td>
</tr>
</table>
</div>
</td><td valign="bottom" class="tab">
<div class="tab-separator">
<table cellspacing="0" cellpadding="0" border="0">
<tr>
<td style="background-image: url(../../skin/images/tab-left.png)" valign="top" width="5" height="5"><img alt="" src="../../skin/images/tab-corner-left.png"></td><td rowspan="2" valign="bottom" class="tab">
<div class="tab-not-selected-shadow">
<div class="tab-not-selected">
<a href="../../installation/index.html"><font face="Arial, Helvetica, Sans-serif">Installation</font></a>
</div>
</div>
</td><td style="background-image: url(../../skin/images/tab-right.png)" valign="top" width="5" height="5"><img alt="" src="../../skin/images/tab-corner-right.png"></td>
</tr>
<tr>
<td style="background-image: url(../../skin/images/tab-left.png)" valign="bottom">
<div class="tab-not-selected-shadow-left">
<img alt="" width="4" src="../../skin/images/spacer.gif"></div>
</td><td style="background-image: url(../../skin/images/tab-right.png)" valign="bottom">
<div class="tab-not-selected-shadow-right">
<img alt="" width="4" src="../../skin/images/spacer.gif"></div>
</td>
</tr>
</table>
</div>
</td><td style="background-image: url(../../skin/images/tab-left-selected.png)" valign="top" width="5"><img alt="" src="../../skin/images/tab-corner-left-selected.png"></td><td valign="bottom" class="tab">
<div class="tab-selected">
<a href="../index.html"><font color="#000000">Documentation</font></a>
</div>
</td><td style="background-image: url(../../skin/images/tab-right-selected.png)" valign="top" width="5"><img alt="" src="../../skin/images/tab-corner-right-selected.png"></td><td valign="bottom" class="tab">
<div class="tab-separator">
<table cellspacing="0" cellpadding="0" border="0">
<tr>
<td style="background-image: url(../../skin/images/tab-left.png)" valign="top" width="5" height="5"><img alt="" src="../../skin/images/tab-corner-left.png"></td><td rowspan="2" valign="bottom" class="tab">
<div class="tab-not-selected-shadow">
<div class="tab-not-selected">
<a href="../../community/index.html"><font face="Arial, Helvetica, Sans-serif">Community</font></a>
</div>
</div>
</td><td style="background-image: url(../../skin/images/tab-right.png)" valign="top" width="5" height="5"><img alt="" src="../../skin/images/tab-corner-right.png"></td>
</tr>
<tr>
<td style="background-image: url(../../skin/images/tab-left.png)" valign="bottom">
<div class="tab-not-selected-shadow-left">
<img alt="" width="4" src="../../skin/images/spacer.gif"></div>
</td><td style="background-image: url(../../skin/images/tab-right.png)" valign="bottom">
<div class="tab-not-selected-shadow-right">
<img alt="" width="4" src="../../skin/images/spacer.gif"></div>
</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<!--================= end Tabs ==================-->
</td>
<!--================= end Group Logo ==================-->
<!--================= start Project Logo ==================--><td width="100%" valign="bottom" align="right" bgcolor="#FFFFFF">
<div style="padding: 10px" class="headerlogo">
<a href="http://cocoon.apache.org/lenya"><img border="0" class="logoImage" alt="Lenya" src="../../images/apache-lenya-light.png"></a>
</div>
<div class="tab-separator"></div>
</td>
<!--================= end Project Logo ==================-->
</tr>
</table>
<!--================= end Banner ==================-->
<div class="tab-bar">
<img alt="" height="5" src="../../skin/images/spacer.gif"></div>
<!--================= start Menu, NavBar, Content ==================-->
<table summary="page content" bgcolor="#ffffff" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top">
<table summary="menu" border="0" cellspacing="0" cellpadding="0">
<tr>
<!--================= start left top NavBar ==================-->
<!--================= end left top NavBar ==================-->
<td valign="top">
<div class="tab-subbar">
<img width="10" height="5" alt="" src="../../skin/images/spacer.gif"></div>
</td><td valign="top">
<!--================= start Menu items ==================-->
<div class="menu">
<div class="menutitle"></div>
<div class="menuitemgroup">
<div class="menutitle">Components</div>
<div class="menuitemgroup">
<div class="menupage">
<div class="menupagetitle">URI Parametrizer</div>
<div class="menupageitemgroup">
<div class="menupageitem">
<a href="#Motivation">Motivation</a>
</div>
<div class="menupageitem">
<a href="#Rationale">Rationale</a>
</div>
</div>
</div>
<div class="menuitem">
<a href="pageenvelopemodule.html">PageEnvelopeModule</a>
</div>
</div>
</div>
</div>
<!--================= end Menu items ==================-->
</td><td valign="top">
<div class="tab-subbar">&nbsp;&nbsp;</div>
</td>
</tr>
<tr>
<td></td><td height="5"><img alt="" width="150" height="1" src="../../skin/images/spacer.gif"></td><td></td>
</tr>
</table>
</td><td valign="top" width="100%">
<table summary="content" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top" colspan="3">
<div class="tab-subbar">&nbsp;&nbsp;</div>
</td>
</tr>
<!--================= start Content==================-->
<tr>
<td align="left" width="10"><img width="10" height="1" alt="" src="../../skin/images/spacer.gif"></td><td align="left" width="100%">
<div class="content">
<table cellspacing="0" cellpadding="0" class="title">
<tr>
<td valign="middle">
<h1>URI Parametrizer</h1>
</td><td nowrap="nowrap" width="40" align="center"><a class="dida" href="URIParametrizer.pdf"><img alt="PDF" src="../../skin/images/pdfdoc.gif" border="0"><br>
          PDF</a></td>
</tr>
</table> 

    
<a name="N101CF"></a><a name="Motivation"></a>
<h3>Motivation</h3>
<div style="margin-left: 0 ; border: 2px">
<p>The problem of <a href="site_siteTree.html">determining the doctype</a>
      independent of request URI needs a flexible and yet simple
      solution. This is where the URI Parametrizer comes to the
      rescue.</p>
</div>

    
<a name="N101DD"></a><a name="Rationale"></a>
<h3>Rationale</h3>
<div style="margin-left: 0 ; border: 2px">
<p>The URI Parametrizer is an action which given an arbitrary
      URI return a configurable number of parameters which it infers
      from this URI. Typical parameters include source document type,
      navigation location, etc. The action itself delegates to task of
      determining the parameters to the Cocoon sitemap, i.e. the
      parameters are determinined using the normal sitemap pipeline
      matching mechanism.</p>
<a name="N101E6"></a><a name="Overview"></a>
<h4>Overview</h4>
<div style="margin-left: 0 ; border: 2px">
<p>The flow of information is outlined in the following
	diagram:</p>
<div align="center">
<img class="figure" alt="Diagram of URIParametrizer" src="images/live/URIParametrizer.png"></div>
</div>
<a name="N101F4"></a><a name="Interfaces"></a>
<h4>Interfaces</h4>
<div style="margin-left: 0 ; border: 2px">
<p>The URIParametrizerAction expects an arbitrary number of
	parameters. Each parameter contains a key value pair which
	denotes the name of the parameter and the source. A typical
	example is as follows:</p>
<pre class="code">
&lt;map:act type="uriparametrizer"&gt;
  &lt;map:parameter name="doctype"
	  value="cocoon://uri-parameter/{publication-id}/doctype"/&gt;
  &lt;map:parameter name="path"
	  value="cocoon://uri-parameter/{publication-id}/path"/&gt;
  &lt;map:generate src="cocoon:/{doctype}/{path}"/&gt;
&lt;/map:act&gt;
</pre>
<p>The <span class="codefrag">uri-parameter</span> prefix is a standard prefix
	which invokes a pipeline in the root sitemap which mounts a
	subsitemap in your publication with the name
	<span class="codefrag">parameter-{parameterName}.xmap</span>.</p>
<p>The action basically just issues a request back to cocoon
	for each parameter. It uses the URI given in the value
	attribute where it also adds the original request URI. So for
	a given request URI <span class="codefrag">foo.html</span> and the parameters
	given above the action basically issues to requests using the
	<span class="codefrag">cocoon:</span> protocol:</p>
<pre class="code">
cocoon://uri-parameter/{publication-id}/doctype/foo.html
cocoon://uri-parameter/{publication-id}/path/foo.html</pre>
<p>The matcher for uri-parameter in the root sitemap then
	tries to mount the sitemaps
	<span class="codefrag">parameter-doctype.xmap</span> and
	<span class="codefrag">parameter-path.xmap</span> in the publication. Then the
	reuest is matched against the parameter sitemap. Here's a very
	simple example of a parameter sitemap:</p>
<pre class="code">
&lt;?xml version="1.0"?&gt;

&lt;map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0"&gt;

  &lt;map:components&gt;
    &lt;map:generators default="file"/&gt;
    &lt;map:transformers default="xslt"/&gt;
    &lt;map:readers default="resource"/&gt;
    &lt;map:serializers default="html"/&gt;
    &lt;map:matchers default="wildcard"/&gt;
    &lt;map:actions/&gt;
  &lt;/map:components&gt;

  &lt;map:views/&gt;

  &lt;map:resources/&gt;

  &lt;map:pipelines&gt;

    &lt;map:pipeline&gt;
      
      &lt;map:match pattern="**"&gt;
	&lt;map:generate type="serverpages" src="content/parameters/doctype.xsp"&gt;
          &lt;map:parameter name="value" value="{1}"/&gt;
        &lt;/map:generate&gt;
	&lt;map:serialize type="xml"/&gt;
      &lt;/map:match&gt;
      
    &lt;/map:pipeline&gt;

  &lt;/map:pipelines&gt;
&lt;/map:sitemap&gt;</pre>
<p>A more serious example could possibly include matchers
	using the SourceTypeAction from the Forrest Project or a
	HashMapAction as outlined in the <a href="site_siteTree.html">SiteTree proposal</a>.</p>
<p>After a match has been found the pipeline in the parameter
	sitemap returns an XML snippet in the following form:</p>
<pre class="code">
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;

&lt;parameter xmlns="http://www.lenya.org/2003/uri-parameters"&gt;article&lt;/parameter&gt;
</pre>
<p>This xml is consequently parsed by the action and returned
	as a HashMap. Inside the action the parameters will be
	available under the names as they were specified in the
	parameters to the action.</p>
</div>
<p>The fact that the actual determination is delegated back to
      the sitemap allows for a combination of the <a href="site_siteTree.html">original proposals</a> where
      solutions such as Hashmap and SourceTypeAction were
      outlined.</p>
</div>

  
</div>
</td><td width="10"><img width="10" height="1" alt="" src="../../skin/images/spacer.gif"></td>
</tr>
<!--================= end Content==================-->
</table>
</td>
</tr>
<tr>
<td>
<br>
<br>
</td>
</tr>
</table>
<!--================= end Menu, NavBar, Content ==================-->
<!--================= start Footer ==================-->
<div class="footer">
<table summary="footer" cellspacing="0" cellpadding="0" width="100%" border="0">
<tr>
<td colspan="2" height="1"><img height="1" width="1" alt="" src="../../skin/images/spacer.gif"><a href="../../skin/images/label.gif"></a><a href="../../skin/images/page.gif"></a><a href="../../skin/images/chapter.gif"></a><a href="../../skin/images/chapter_open.gif"></a><a href="../../skin/images/current.gif"></a></td>
</tr>
<tr>
<td colspan="2" class="copyright" align="center" width="90%"><span class="footnote">Copyright &copy;
                2002-2003&nbsp;The Apache Software Foundation. All rights reserved.
                <br>
<script type="text/javascript" language="JavaScript"><!--
                  document.write(" - "+"Last Published: " + document.lastModified);
                  //  --></script></span></td><td nowrap="nowrap" align="right" class="logos"><a href="http://validator.w3.org/check/referer"><img width="88" height="31" alt="Valid HTML 4.01!" src="../../skin/images/valid-html401.png" class="logoImage" border="0"></a><a href="http://jigsaw.w3.org/css-validator/"><img width="88" height="31" alt="Valid CSS!" src="../../skin/images/vcss.png" class="logoImage" border="0"></a></td>
</tr>
</table>
</div>
<!--================= end Footer ==================-->
</body>
</html>
