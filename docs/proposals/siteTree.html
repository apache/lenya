<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Site Tree</title>
<link type="text/css" href="../../skin/page.css" rel="stylesheet">
</head>
<body text="#000000" bgcolor="#FFFFFF">
<!--================= start Banner ==================-->
<table summary="header with logos" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<!--================= start Group Logo ==================-->
<td valign="bottom" bgcolor="#FFFFFF">
<div class="headerlogo">
<a href="http://cocoon.apache.org"><img border="0" class="logoImage" alt="Apache Cocoon" src="../../images/cocoon-project-logo-big.png"></a>
</div>
<span class="textheader">Apache Cocoon</span>
<!--================= start Tabs ==================-->
<div class="tab">
<table summary="tab bar" border="0" cellpadding="0" cellspacing="0">
<tr>
<td width="10" valign="bottom">
<div class="tab-separator">
<img alt="" width="10" src="../../skin/images/spacer.gif"></div>
</td><td valign="bottom" class="tab">
<div class="tab-separator">
<table cellspacing="0" cellpadding="0" border="0">
<tr>
<td style="background-image: url(../../skin/images/tab-left.png)" valign="top" width="5" height="5"><img alt="" src="../../skin/images/tab-corner-left.png"></td><td rowspan="2" valign="bottom" class="tab">
<div class="tab-not-selected-shadow">
<div class="tab-not-selected">
<a href="../../project/index.html"><font face="Arial, Helvetica, Sans-serif">Project Information</font></a>
</div>
</div>
</td><td style="background-image: url(../../skin/images/tab-right.png)" valign="top" width="5" height="5"><img alt="" src="../../skin/images/tab-corner-right.png"></td>
</tr>
<tr>
<td style="background-image: url(../../skin/images/tab-left.png)" valign="bottom">
<div class="tab-not-selected-shadow-left">
<img alt="" width="4" src="../../skin/images/spacer.gif"></div>
</td><td style="background-image: url(../../skin/images/tab-right.png)" valign="bottom">
<div class="tab-not-selected-shadow-right">
<img alt="" width="4" src="../../skin/images/spacer.gif"></div>
</td>
</tr>
</table>
</div>
</td><td valign="bottom" class="tab">
<div class="tab-separator">
<table cellspacing="0" cellpadding="0" border="0">
<tr>
<td style="background-image: url(../../skin/images/tab-left.png)" valign="top" width="5" height="5"><img alt="" src="../../skin/images/tab-corner-left.png"></td><td rowspan="2" valign="bottom" class="tab">
<div class="tab-not-selected-shadow">
<div class="tab-not-selected">
<a href="../../installation/index.html"><font face="Arial, Helvetica, Sans-serif">Installation</font></a>
</div>
</div>
</td><td style="background-image: url(../../skin/images/tab-right.png)" valign="top" width="5" height="5"><img alt="" src="../../skin/images/tab-corner-right.png"></td>
</tr>
<tr>
<td style="background-image: url(../../skin/images/tab-left.png)" valign="bottom">
<div class="tab-not-selected-shadow-left">
<img alt="" width="4" src="../../skin/images/spacer.gif"></div>
</td><td style="background-image: url(../../skin/images/tab-right.png)" valign="bottom">
<div class="tab-not-selected-shadow-right">
<img alt="" width="4" src="../../skin/images/spacer.gif"></div>
</td>
</tr>
</table>
</div>
</td><td style="background-image: url(../../skin/images/tab-left-selected.png)" valign="top" width="5"><img alt="" src="../../skin/images/tab-corner-left-selected.png"></td><td valign="bottom" class="tab">
<div class="tab-selected">
<a href="../index.html"><font color="#000000">Documentation</font></a>
</div>
</td><td style="background-image: url(../../skin/images/tab-right-selected.png)" valign="top" width="5"><img alt="" src="../../skin/images/tab-corner-right-selected.png"></td><td valign="bottom" class="tab">
<div class="tab-separator">
<table cellspacing="0" cellpadding="0" border="0">
<tr>
<td style="background-image: url(../../skin/images/tab-left.png)" valign="top" width="5" height="5"><img alt="" src="../../skin/images/tab-corner-left.png"></td><td rowspan="2" valign="bottom" class="tab">
<div class="tab-not-selected-shadow">
<div class="tab-not-selected">
<a href="../../community/index.html"><font face="Arial, Helvetica, Sans-serif">Community</font></a>
</div>
</div>
</td><td style="background-image: url(../../skin/images/tab-right.png)" valign="top" width="5" height="5"><img alt="" src="../../skin/images/tab-corner-right.png"></td>
</tr>
<tr>
<td style="background-image: url(../../skin/images/tab-left.png)" valign="bottom">
<div class="tab-not-selected-shadow-left">
<img alt="" width="4" src="../../skin/images/spacer.gif"></div>
</td><td style="background-image: url(../../skin/images/tab-right.png)" valign="bottom">
<div class="tab-not-selected-shadow-right">
<img alt="" width="4" src="../../skin/images/spacer.gif"></div>
</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<!--================= end Tabs ==================-->
</td>
<!--================= end Group Logo ==================-->
<!--================= start Project Logo ==================--><td width="100%" valign="bottom" align="right" bgcolor="#FFFFFF">
<div style="padding: 10px" class="headerlogo">
<a href="http://www.lenya.org"><img border="0" class="logoImage" alt="Lenya" src="../../images/apache-lenya-light.png"></a>
</div>
<div class="tab-separator"></div>
</td>
<!--================= end Project Logo ==================-->
</tr>
</table>
<!--================= end Banner ==================-->
<div class="tab-bar">
<img alt="" height="5" src="../../skin/images/spacer.gif"></div>
<!--================= start Menu, NavBar, Content ==================-->
<table summary="page content" bgcolor="#ffffff" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top">
<table summary="menu" border="0" cellspacing="0" cellpadding="0">
<tr>
<!--================= start left top NavBar ==================-->
<!--================= end left top NavBar ==================-->
<td valign="top">
<div class="tab-subbar">
<img width="10" height="5" alt="" src="../../skin/images/spacer.gif"></div>
</td><td valign="top">
<!--================= start Menu items ==================-->
<div class="menu">
<div class="menutitle"></div>
<div class="menuitemgroup">
<div class="menutitle">Proposals / Requests for Comment (RFC)</div>
<div class="menuitemgroup">
<div class="menupage">
<div class="menupagetitle">Site tree</div>
<div class="menupageitemgroup">
<div class="menupageitem">
<a href="#Motivation">Motivation</a>
</div>
<div class="menupageitem">
<a href="#Rationale">Rationale</a>
</div>
<div class="menupageitem">
<a href="#The+Sitetree+Schema">The Sitetree Schema</a>
</div>
<div class="menupageitem">
<a href="#Backwards+Compatibility">Backwards Compatibility</a>
</div>
<div class="menupageitem">
<a href="#Roadmap">Roadmap</a>
</div>
<div class="menupageitem">
<a href="#Reference+Implementation">Reference Implementation</a>
</div>
</div>
</div>
<div class="menuitem">
<a href="openoffice.html">OpenOffice</a>
</div>
</div>
</div>
</div>
<!--================= end Menu items ==================-->
</td><td valign="top">
<div class="tab-subbar">&nbsp;&nbsp;</div>
</td>
</tr>
<tr>
<td></td><td height="5"><img alt="" width="150" height="1" src="../../skin/images/spacer.gif"></td><td></td>
</tr>
</table>
</td><td valign="top" width="100%">
<table summary="content" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top" colspan="3">
<div class="tab-subbar">&nbsp;&nbsp;</div>
</td>
</tr>
<!--================= start Content==================-->
<tr>
<td align="left" width="10"><img width="10" height="1" alt="" src="../../skin/images/spacer.gif"></td><td align="left" width="100%">
<div class="content">
<table cellspacing="0" cellpadding="0" class="title">
<tr>
<td valign="middle">
<h1>Site Tree</h1>
</td><td nowrap="nowrap" width="40" align="center"><a class="dida" href="siteTree.pdf"><img alt="PDF" src="../../skin/images/pdfdoc.gif" border="0"><br>
          PDF</a></td>
</tr>
</table> 

    
<a name="N101D3"></a><a name="Motivation"></a>
<h3>Motivation</h3>
<div style="margin-left: 0 ; border: 2px">
<p>Currently there is no standard way to manage the navigation
in Lenya. Previous attempts have shown their own merits and
drawbacks. A general and standard approach is needed.</p>
</div>

    
<a name="N101DD"></a><a name="Rationale"></a>
<h3>Rationale</h3>
<div style="margin-left: 0 ; border: 2px">
<p>The basic problems we're trying to solve are as follows:</p>
<ol>
	
<li>Maintain the navigation in an easy format independent of
	the actual storage of the documents.</li> 
	
<li>Enable moving of documents.</li>
	
<li>Enable querying of doctype independent of request URI.</li>
      
</ol>
<a name="N101F2"></a><a name="Navigation"></a>
<h4>Navigation</h4>
<div style="margin-left: 0 ; border: 2px">
<p>There are a couple of known implementations to choose from:</p>
<ul>
	  
<li>The existing Lenya tree.xml</li> 
	  
<li>The Forrest site.xml.</li>
	  
<li>The hashmap way: A sitetree.xml and purlspace.xml combination
   where the purlspace.xml contains all existing documents and
   sitetree.xml contains the navigation hierarchy.</li>
	
</ul>
</div>
<a name="N10208"></a><a name="Moving+Of+Documents"></a>
<h4>Moving Of Documents</h4>
<div style="margin-left: 0 ; border: 2px">
<p>The Forrest site.xml solves this quite elegantly: Due to the use of
XPath and some ambiguity the documents can be found almost
independent of their actual location</p>
<p>With the existing Lenya or the hashmap solution changing of document
location requires editing of the tree.xml or the purlspace.xml
respectively.</p>
</div>
<a name="N10215"></a><a name="Doctype+Querying"></a>
<h4>Doctype Querying</h4>
<div style="margin-left: 0 ; border: 2px">
<p>For question 3 there are a couple of known approaches:</p>
<a name="N1021E"></a><a name="Hashmap"></a>
<h5>Hashmap</h5>
<div style="margin-left: 0 ; border: 2px">
<p>This method uses an action which contains for each
   request URI a mapping to attributes such as doctype, srcfile, xslt,
   etc.</p>
</div>
<a name="N10228"></a><a name="Forrest+SourceTypeAction"></a>
<h5>Forrest SourceTypeAction</h5>
<div style="margin-left: 0 ; border: 2px">
<p>Forrest contains an action which for a given request
   opens the source file and determines its doctype based on the dtd
   declaration.</p>
</div>
<a name="N10232"></a><a name="URIParametrizer"></a>
<h5>URIParametrizer</h5>
<div style="margin-left: 0 ; border: 2px">
<p>The URIParametrizer is a black box (probably an action)
   which internally issues cocoon requests to different sitemaps which
   return different attributes (doctype, etc.) for a given request
   URI.</p>
<p>This amounts to a combination of the hashmap solution
   with the basic cocoon concepts: The request URIs aren't matched
   against a hashmap but are handled by a sitemap instead. The sitemap
   contains normal pipelines and matchers which match on the
   request. As a catch-all there is still the possibility of using a
   hashmap for URIs that didn't match any pipelines.</p>
<p>Finally a new (internal) request is generated using the
   parameter values. This request is handled by a normal cocoon
   sitemap as if the original request had contained these
   parameters.</p>
<div align="center">
<img class="figure" alt="Diagram of URIParametrizer" src="images/live/URIParametrizer.png"></div>
</div>
</div>
</div>
    
    
<a name="N10248"></a><a name="The+Sitetree+Schema"></a>
<h3>The Sitetree Schema</h3>
<div style="margin-left: 0 ; border: 2px">
<p>The proposed sitetree schema looks as follows:</p>
<pre class="code">
&lt;?xml version="1.0"?&gt;

&lt;xs:schema
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    targetNamespace="http://www.lenya.org/2003/sitetree"
    xmlns="http://www.lenya.org/2003/sitetree"
    elementFormDefault="qualified"&gt;
    
  &lt;xs:element name="site"&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element ref="node"
            minOccurs="0" maxOccurs="unbounded"/&gt;
      &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;
  
  &lt;xs:element name="node"&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element ref="node"
            minOccurs="0" maxOccurs="unbounded"/&gt;
      &lt;/xs:sequence&gt;
      &lt;xs:attribute name="href" type="xs:string"/&gt;
      &lt;xs:attribute name="label" type="xs:string"/&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;
    
&lt;/xs:schema&gt;
</pre>
<p>
        An example <span class="codefrag">sitetree.xml</span> could look like follows:
      </p>
<pre class="code">
&lt;site
    xmlns="http://www.lenya.org/2003/sitetree"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation=
        "http://www.lenya.org/2003/sitetree
        ../../../../resources/entities/sitetree.xsd"&gt;
    
  &lt;node href="index.html" label="Home"/&gt;
  
  &lt;node href="demo/" label="Demo"&gt;
    &lt;node href="unipublic.html" label="Unipublic"/&gt;
    &lt;node href="news.html" label="Wyona News and Comments"/&gt;
    &lt;node href="oscom.html" label="OSCOM"/&gt;
  &lt;/node&gt;
  
  &lt;node href="download/" label="Download"&gt;
    &lt;node href="source.html" label="Source Version"/&gt;
    &lt;node href="binary.html" label="Binary Version"/&gt;
  &lt;/node&gt;
  
  &lt;node href="documentation/" label="Documentation"/&gt;

&lt;/site&gt;
</pre>
</div>

    
<a name="N10262"></a><a name="Backwards+Compatibility"></a>
<h3>Backwards Compatibility</h3>
<div style="margin-left: 0 ; border: 2px">
<p>There has not been a previous implementation, so this is a non-issue.</p>
</div>

    
<a name="N1026C"></a><a name="Roadmap"></a>
<h3>Roadmap</h3>
<div style="margin-left: 0 ; border: 2px">
<ul>
	
<li>Decide which solution to choose</li>
      
</ul>
</div>

    
<a name="N10279"></a><a name="Reference+Implementation"></a>
<h3>Reference Implementation</h3>
<div style="margin-left: 0 ; border: 2px">
<p>None</p>
</div>

  
</div>
</td><td width="10"><img width="10" height="1" alt="" src="../../skin/images/spacer.gif"></td>
</tr>
<!--================= end Content==================-->
</table>
</td>
</tr>
<tr>
<td>
<br>
<br>
</td>
</tr>
</table>
<!--================= end Menu, NavBar, Content ==================-->
<!--================= start Footer ==================-->
<div class="footer">
<table summary="footer" cellspacing="0" cellpadding="0" width="100%" border="0">
<tr>
<td colspan="2" height="1"><img height="1" width="1" alt="" src="../../skin/images/spacer.gif"><a href="../../skin/images/label.gif"></a><a href="../../skin/images/page.gif"></a><a href="../../skin/images/chapter.gif"></a><a href="../../skin/images/chapter_open.gif"></a><a href="../../skin/images/current.gif"></a></td>
</tr>
<tr>
<td colspan="2" class="copyright" align="center" width="90%"><span class="footnote">Copyright &copy;
                2002-2003&nbsp;The Apache Software Foundation. All rights reserved.
                <br>
<script type="text/javascript" language="JavaScript"><!--
                  document.write(" - "+"Last Published: " + document.lastModified);
                  //  --></script></span></td><td nowrap="nowrap" align="right" class="logos"><a href="http://validator.w3.org/check/referer"><img width="88" height="31" alt="Valid HTML 4.01!" src="../../skin/images/valid-html401.png" class="logoImage" border="0"></a><a href="http://jigsaw.w3.org/css-validator/"><img width="88" height="31" alt="Valid CSS!" src="../../skin/images/vcss.png" class="logoImage" border="0"></a></td>
</tr>
</table>
</div>
<!--================= end Footer ==================-->
</body>
</html>
