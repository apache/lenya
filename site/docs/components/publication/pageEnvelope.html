<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Page Envelope</title>
<link type="text/css" href="../../../skin/page.css" rel="stylesheet">
</head>
<body text="#000000" bgcolor="#FFFFFF">
<!--================= start Banner ==================-->
<table summary="header with logos" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<!--================= start Group Logo ==================-->
<td valign="bottom" bgcolor="#FFFFFF">
<div class="headerlogo">
<a href="http://cocoon.apache.org"><img border="0" class="logoImage" alt="Apache Cocoon" src="../../../images/cocoon-project-logo-big.png"></a>
</div>
<span class="textheader">Apache Cocoon</span>
<!--================= start Tabs ==================-->
<div class="tab">
<table summary="tab bar" border="0" cellpadding="0" cellspacing="0">
<tr>
<td width="10" valign="bottom">
<div class="tab-separator">
<img alt="" width="10" src="../../../skin/images/spacer.gif"></div>
</td><td valign="bottom" class="tab">
<div class="tab-separator">
<table cellspacing="0" cellpadding="0" border="0">
<tr>
<td style="background-image: url(../../../skin/images/tab-left.png)" valign="top" width="5" height="5"><img alt="" src="../../../skin/images/tab-corner-left.png"></td><td rowspan="2" valign="bottom" class="tab">
<div class="tab-not-selected-shadow">
<div class="tab-not-selected">
<a href="../../../project/index.html"><font face="Arial, Helvetica, Sans-serif">Project Information</font></a>
</div>
</div>
</td><td style="background-image: url(../../../skin/images/tab-right.png)" valign="top" width="5" height="5"><img alt="" src="../../../skin/images/tab-corner-right.png"></td>
</tr>
<tr>
<td style="background-image: url(../../../skin/images/tab-left.png)" valign="bottom">
<div class="tab-not-selected-shadow-left">
<img alt="" width="4" src="../../../skin/images/spacer.gif"></div>
</td><td style="background-image: url(../../../skin/images/tab-right.png)" valign="bottom">
<div class="tab-not-selected-shadow-right">
<img alt="" width="4" src="../../../skin/images/spacer.gif"></div>
</td>
</tr>
</table>
</div>
</td><td valign="bottom" class="tab">
<div class="tab-separator">
<table cellspacing="0" cellpadding="0" border="0">
<tr>
<td style="background-image: url(../../../skin/images/tab-left.png)" valign="top" width="5" height="5"><img alt="" src="../../../skin/images/tab-corner-left.png"></td><td rowspan="2" valign="bottom" class="tab">
<div class="tab-not-selected-shadow">
<div class="tab-not-selected">
<a href="../../../installation/index.html"><font face="Arial, Helvetica, Sans-serif">Installation</font></a>
</div>
</div>
</td><td style="background-image: url(../../../skin/images/tab-right.png)" valign="top" width="5" height="5"><img alt="" src="../../../skin/images/tab-corner-right.png"></td>
</tr>
<tr>
<td style="background-image: url(../../../skin/images/tab-left.png)" valign="bottom">
<div class="tab-not-selected-shadow-left">
<img alt="" width="4" src="../../../skin/images/spacer.gif"></div>
</td><td style="background-image: url(../../../skin/images/tab-right.png)" valign="bottom">
<div class="tab-not-selected-shadow-right">
<img alt="" width="4" src="../../../skin/images/spacer.gif"></div>
</td>
</tr>
</table>
</div>
</td><td style="background-image: url(../../../skin/images/tab-left-selected.png)" valign="top" width="5"><img alt="" src="../../../skin/images/tab-corner-left-selected.png"></td><td valign="bottom" class="tab">
<div class="tab-selected">
<a href="../../index.html"><font color="#000000">Documentation</font></a>
</div>
</td><td style="background-image: url(../../../skin/images/tab-right-selected.png)" valign="top" width="5"><img alt="" src="../../../skin/images/tab-corner-right-selected.png"></td><td valign="bottom" class="tab">
<div class="tab-separator">
<table cellspacing="0" cellpadding="0" border="0">
<tr>
<td style="background-image: url(../../../skin/images/tab-left.png)" valign="top" width="5" height="5"><img alt="" src="../../../skin/images/tab-corner-left.png"></td><td rowspan="2" valign="bottom" class="tab">
<div class="tab-not-selected-shadow">
<div class="tab-not-selected">
<a href="../../../community/index.html"><font face="Arial, Helvetica, Sans-serif">Community</font></a>
</div>
</div>
</td><td style="background-image: url(../../../skin/images/tab-right.png)" valign="top" width="5" height="5"><img alt="" src="../../../skin/images/tab-corner-right.png"></td>
</tr>
<tr>
<td style="background-image: url(../../../skin/images/tab-left.png)" valign="bottom">
<div class="tab-not-selected-shadow-left">
<img alt="" width="4" src="../../../skin/images/spacer.gif"></div>
</td><td style="background-image: url(../../../skin/images/tab-right.png)" valign="bottom">
<div class="tab-not-selected-shadow-right">
<img alt="" width="4" src="../../../skin/images/spacer.gif"></div>
</td>
</tr>
</table>
</div>
</td>
</tr>
</table>
</div>
<!--================= end Tabs ==================-->
</td>
<!--================= end Group Logo ==================-->
<!--================= start Project Logo ==================--><td width="100%" valign="bottom" align="right" bgcolor="#FFFFFF">
<div style="padding: 10px" class="headerlogo">
<a href="http://cocoon.apache.org/lenya"><img border="0" class="logoImage" alt="Lenya" src="../../../images/apache-lenya-light.png"></a>
</div>
<div class="tab-separator"></div>
</td>
<!--================= end Project Logo ==================-->
</tr>
</table>
<!--================= end Banner ==================-->
<div class="tab-bar">
<img alt="" height="5" src="../../../skin/images/spacer.gif"></div>
<!--================= start Menu, NavBar, Content ==================-->
<table summary="page content" bgcolor="#ffffff" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top">
<table summary="menu" border="0" cellspacing="0" cellpadding="0">
<tr>
<!--================= start left top NavBar ==================-->
<!--================= end left top NavBar ==================-->
<td valign="top">
<div class="tab-subbar">
<img width="10" height="5" alt="" src="../../../skin/images/spacer.gif"></div>
</td><td valign="top">
<!--================= start Menu items ==================-->
<div class="menu">
<div class="menutitle"></div>
<div class="menuitemgroup">
<div class="menutitle">Integrator/Dev Guide</div>
<div class="menuitemgroup">
<div class="menutitle">Components</div>
<div class="menuitemgroup">
<div class="menutitle">Publication</div>
<div class="menuitemgroup">
<div class="menupage">
<div class="menupagetitle">Page envelope</div>
<div class="menupageitemgroup">
<div class="menupageitem">
<a href="#Introduction">Introduction</a>
</div>
<div class="menupageitem">
<a href="#Proposal">Proposal</a>
</div>
<div class="menupageitem">
<a href="#Current+Parameters">Current Parameters</a>
</div>
<div class="menupageitem">
<a href="#The+Java+API">The Java API</a>
</div>
<div class="menupageitem">
<a href="#TODO">TODO</a>
</div>
</div>
</div>
<div class="menuitem">
<a href="pageenvelopemodule.html">PageEnvelopeModule</a>
</div>
<div class="menuitem">
<a href="siteTree.html">Site tree</a>
</div>
</div>
</div>
</div>
</div>
</div>
<!--================= end Menu items ==================-->
</td><td valign="top">
<div class="tab-subbar">&nbsp;&nbsp;</div>
</td>
</tr>
<tr>
<td></td><td height="5"><img alt="" width="150" height="1" src="../../../skin/images/spacer.gif"></td><td></td>
</tr>
</table>
</td><td valign="top" width="100%">
<table summary="content" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top" colspan="3">
<div class="tab-subbar">&nbsp;&nbsp;</div>
</td>
</tr>
<!--================= start Content==================-->
<tr>
<td align="left" width="10"><img width="10" height="1" alt="" src="../../../skin/images/spacer.gif"></td><td align="left" width="100%">
<div class="content">
<table cellspacing="0" cellpadding="0" class="title">
<tr>
<td valign="middle">
<h1>Page Envelope</h1>
</td><td nowrap="nowrap" width="40" align="center"><a class="dida" href="pageEnvelope.pdf"><img alt="PDF" src="../../../skin/images/pdfdoc.gif" border="0"><br>
          PDF</a></td>
</tr>
</table> 

    
<a name="N101D7"></a><a name="Introduction"></a>
<h3>Introduction</h3>
<div style="margin-left: 0 ; border: 2px">
<p>The Lenya CMS needs to pass arguments (user, time, context,
	etc.) to the subcomponents in the sitemap or to futher
	invocations of itself in one session. Currently there is a mix
	of multiple mechanisms to achieve this. We want to standardize
	this across Lenya.</p>
<p>One possible solution is to use a so-called "Page Envelope"
      which wraps all XML documents with some meta information that
      contains a standard set of arguments which are then passed to
      the subcomponents through the Cocoon pipelines and could
      possibly be attached to the session to keep this information
      across client round trips.</p>
</div>

    
<a name="N101E4"></a><a name="Proposal"></a>
<h3>Proposal</h3>
<div style="margin-left: 0 ; border: 2px">
<p>A possible solution could look as follows:</p>
<pre class="code">
&lt;lenya:envelope&gt;
  &lt;lenya:head&gt;
    &lt;lenya:user&gt;foo&lt;/lenya:user&gt;
    &lt;lenya:date&gt;2003-2-11&lt;/lenya:date&gt;
    &lt;lenya:publication&gt;sample&lt;/lenya:publication&gt;
      .
      .
      .
    &lt;xul:menubar id="sample-menubar"&gt;
      .
      .
      .
    &lt;/xul:menubar&gt;
  &lt;/lenya:head&gt;
  &lt;lenya:body&gt;
    +--------------------------+
    |                  	       |
    |   Document       	       |
    |   Content       	       |
    |                  	       |
    +--------------------------+
  &lt;/lenya:body&gt;
&lt;/lenya&gt;
</pre>
</div>

    
<a name="N101F3"></a><a name="Current+Parameters"></a>
<h3>Current Parameters</h3>
<div style="margin-left: 0 ; border: 2px">
<p>Currently, the following variables are defined within Lenya (see &lt;xsp-lenya:util/&gt;):</p>
<ul>
	
<li>context</li>
	
<li>request_uri</li>
    
<li>sitemap_uri</li>
    
<li>current_username</li>
    
<li>no_username_yet</li>
    
<li>no_session_yet</li>
    
<li>server_time</li>
    
<li>context_prefix</li>
    
<li>referer</li>  
    
<li>no_referer</li>   
           
</ul>
</div>
    

<a name="N1021E"></a><a name="The+Java+API"></a>
<h3>The Java API</h3>
<div style="margin-left: 0 ; border: 2px">
<p>
The Java API of the page envelope consists of the following classes:
</p>
<dl>
  
<dt>
<span class="codefrag">org.apache.lenya.cms.publication.PageEvelope</span>
</dt>
  
<dd>An object of this class represents a page envelope.</dd>
  
  
<dt>
<span class="codefrag">org.apache.lenya.cms.cocoon.acting.PageEvelopeAction</span>
</dt>
  
<dd>This action makes the page envelope attributes available as sitemap parameters.</dd>



</dl>
</div>

    
<a name="N10238"></a><a name="TODO"></a>
<h3>TODO</h3>
<div style="margin-left: 0 ; border: 2px">
<p>The proposal is currently not much more than an idea. It
      needs to be properly thought out in regards to the following
      problems:</p>
<ul>
	
<li>The idea works ok as long as the Page Envelope is handed
	down one pipeline. What happens with call-resource
	invocations?</li>
	
<li>What happens with client roundtrips? How is the Page
	Envelope made persistent? Does it need to be?</li>
      
</ul>
</div>

  
</div>
</td><td width="10"><img width="10" height="1" alt="" src="../../../skin/images/spacer.gif"></td>
</tr>
<!--================= end Content==================-->
</table>
</td>
</tr>
<tr>
<td>
<br>
<br>
</td>
</tr>
</table>
<!--================= end Menu, NavBar, Content ==================-->
<!--================= start Footer ==================-->
<div class="footer">
<table summary="footer" cellspacing="0" cellpadding="0" width="100%" border="0">
<tr>
<td colspan="2" height="1"><img height="1" width="1" alt="" src="../../../skin/images/spacer.gif"><a href="../../../skin/images/label.gif"></a><a href="../../../skin/images/page.gif"></a><a href="../../../skin/images/chapter.gif"></a><a href="../../../skin/images/chapter_open.gif"></a><a href="../../../skin/images/current.gif"></a></td>
</tr>
<tr>
<td colspan="2" class="copyright" align="center" width="90%"><span class="footnote">Copyright &copy;
                2002-2003&nbsp;The Apache Software Foundation. All rights reserved.
                <br>
<script type="text/javascript" language="JavaScript"><!--
                  document.write(" - "+"Last Published: " + document.lastModified);
                  //  --></script></span></td><td nowrap="nowrap" align="right" class="logos"><a href="http://validator.w3.org/check/referer"><img width="88" height="31" alt="Valid HTML 4.01!" src="../../../skin/images/valid-html401.png" class="logoImage" border="0"></a><a href="http://jigsaw.w3.org/css-validator/"><img width="88" height="31" alt="Valid CSS!" src="../../../skin/images/vcss.png" class="logoImage" border="0"></a></td>
</tr>
</table>
</div>
<!--================= end Footer ==================-->
</body>
</html>
