<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.8-dev">
<meta name="Forrest-skin-name" content="pelt">
<title>Meta Data</title>
<link type="text/css" href="../../skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="../../skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="../../skin/print.css" rel="stylesheet">
<link type="text/css" href="../../skin/profile.css" rel="stylesheet">
<script src="../../skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="../../skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="../../skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="../../favicon.ico">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
<a href="http://www.apache.org/">apache</a> &gt; <a href="http://lenya.apache.org/">lenya</a><script src="../../skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
</div>
<!--+
    |header
    +-->
<div class="header">
<!--+
    |start group logo
    +-->
<div class="grouplogo">
<a href=""><img class="logoImage" alt="Lenya" src="../../images/apache-lenya-light.png" title=""></a>
</div>
<!--+
    |end group logo
    +-->
<!--+
    |start Project Logo
    +-->
<div class="projectlogo">
<a href=""></a>
</div>
<!--+
    |end Project Logo
    +-->
<!--+
    |start Search
    +-->
<div class="searchbox">
<form action="http://www.google.com/search" method="get" class="roundtopsmall">
<input value="lenya.apache.org" name="sitesearch" type="hidden"><input onFocus="getBlank (this, 'Search the site with ');" size="25" name="q" id="query" type="text" value="Search the site with ">&nbsp; 
                    <input name="Search" value="Search" type="submit">
</form>
</div>
<!--+
    |end search
    +-->
<!--+
    |start Tabs
    +-->
<ul id="tabs">
<li>
<a class="base-not-selected" href="../../index.html">Project</a>
</li>
<li class="current">
<a class="base-selected" href="../../1_4/index.html">Version 1.4</a>
</li>
<li>
<a class="base-not-selected" href="../../modules/index.html">Modules</a>
</li>
<li>
<a class="base-not-selected" href="../../1_2_x/index.html">Version 1.2</a>
</li>
<li>
<a class="base-not-selected" href="../../community/index.html">Community</a>
</li>
</ul>
<!--+
    |end Tabs
    +-->
</div>
</div>
<div id="main">
<div id="publishedStrip">
<!--+
    |start Subtabs
    +-->
<div id="level2tabs"></div>
<!--+
    |end Endtabs
    +-->
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
             
             &nbsp;
           </div>
<!--+
    |start Menu, mainarea
    +-->
<!--+
    |start Menu
    +-->
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', '../../skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('../../skin/images/chapter_open.gif');">Version 1.4</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="../../1_4/index.html">Index</a>
</div>
<div class="menuitem">
<a href="../../1_4/faq.html">FAQs</a>
</div>
<div onclick="SwitchMenu('menu_1.1.3', '../../skin/')" id="menu_1.1.3Title" class="menutitle">Installation</div>
<div id="menu_1.1.3" class="menuitemgroup">
<div class="menuitem">
<a href="../../1_4/installation/index.html">Download</a>
</div>
<div class="menuitem">
<a href="../../1_4/installation/subversion.html">Subversion Access</a>
</div>
<div class="menuitem">
<a href="../../1_4/installation/source_version.html">Install Instructions</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.4', '../../skin/')" id="menu_1.1.4Title" class="menutitle">Concepts</div>
<div id="menu_1.1.4" class="menuitemgroup">
<div class="menuitem">
<a href="../../1_4/concepts/publication.html">Publication</a>
</div>
<div class="menuitem">
<a href="../../1_4/concepts/urlMapping.html">URL Mapping</a>
</div>
<div class="menuitem">
<a href="../../1_4/concepts/authoring_live.html">Authoring and Live mode</a>
</div>
<div class="menuitem">
<a href="../../1_4/concepts/wysiwyg.html">WYSIWYG</a>
</div>
</div>
<div onclick="SwitchMenu('menu_selected_1.1.5', '../../skin/')" id="menu_selected_1.1.5Title" class="menutitle" style="background-image: url('../../skin/images/chapter_open.gif');">Technical Reference</div>
<div id="menu_selected_1.1.5" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="../../1_4/reference/lenya-sitemaps.html">Overview of Lenya Sitemaps</a>
</div>
<div onclick="SwitchMenu('menu_1.1.5.2', '../../skin/')" id="menu_1.1.5.2Title" class="menutitle">Usecase Framework</div>
<div id="menu_1.1.5.2" class="menuitemgroup">
<div class="menuitem">
<a href="../../1_4/reference/usecase-framework/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../../1_4/reference/usecase-framework/abstractusecase.html">AbstractUsecase</a>
</div>
</div>
<div class="menuitem">
<a href="../../1_4/reference/publication-templating/index.html">Publication Templating</a>
</div>
<div class="menuitem">
<a href="../../1_4/reference/resource-types.html">Resource Types</a>
</div>
<div class="menuitem">
<a href="../../1_4/reference/modules/index.html">Modules</a>
</div>
<div class="menupage">
<div class="menupagetitle">Meta data</div>
<div class="menupageitemgroup">
<div class="menupageitem">
<a href="#Introduction">Introduction</a>
</div>
<div class="menupageitem">
<a title="Registering Meta Data Element Sets" href="#Registering+Meta+Data+Element+Sets">Registering Meta Da...</a>
</div>
<div class="menupageitem">
<a title="Accessing Meta Data" href="#Accessing+Meta+Data">Accessing Meta Data...</a>
</div>
<div class="menupageitem">
<a title="The Meta Data Input Module" href="#The+Meta+Data+Input+Module">The Meta Data Input...</a>
</div>
<div class="menupageitem">
<a href="#Storage">Storage</a>
</div>
<div class="menupageitem">
<a href="#Implementation">Implementation</a>
</div>
</div>
</div>
<div onclick="SwitchMenu('menu_1.1.5.7', '../../skin/')" id="menu_1.1.5.7Title" class="menutitle">Protocols</div>
<div id="menu_1.1.5.7" class="menuitemgroup">
<div class="menuitem">
<a href="../../1_4/reference/protocols/index.html">Overview</a>
</div>
<div class="menuitem">
<a href="../../1_4/reference/protocols/lenya.html">lenya:</a>
</div>
<div class="menuitem">
<a href="../../1_4/reference/protocols/lenyadoc.html">lenyadoc:</a>
</div>
</div>
<div class="menuitem">
<a href="../../1_4/reference/link-management.html">Link Management</a>
</div>
<div class="menuitem">
<a href="../../1_4/reference/notification.html">Notification</a>
</div>
<div class="menuitem">
<a href="../../1_4/reference/repository/index.html">Repository</a>
</div>
<div class="menuitem">
<a href="../../1_4/reference/tests.html">Writing Tests</a>
</div>
</div>
<div class="menuitem">
<a href="../../../apidocs/1.4/index.html">1.4 API (Javadoc)</a>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="../../skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<!--+
  |alternative credits
  +-->
<div id="credit2">
<a href="http://apachecon.com/"><img border="0" title="ApacheCon EU 2006" alt="ApacheCon EU 2006 - logo" src="http://www.eu.apachecon.com/konferenzen/apachecon06/images/header-left.gif" style="width: 150px;height: 50px;"></a>
</div>
</div>
<!--+
    |end Menu
    +-->
<!--+
    |start content
    +-->
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="metadata.pdf"><img alt="PDF -icon" src="../../skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Meta Data</h1>
    
<a name="N1000E"></a><a name="Introduction"></a>
<h2 class="h3">Introduction</h2>
<div class="section">
<p>
        Meta data are organized in <em>element sets</em>.
        An element set is identified using a namespace URI.
        Each element set can supply a fixed set of elements.
        An element is identified using a name. An element can
        be <em>editable</em>, and it can support <em>multiple values</em>.
      </p>
</div>
    
    
<a name="N10021"></a><a name="Registering+Meta+Data+Element+Sets"></a>
<h2 class="h3">Registering Meta Data Element Sets</h2>
<div class="section">
<p>Element sets are declared using patch files for <span class="codefrag">cocoon.xconf</span>.
      When the application starts up, they are registered with the <span class="codefrag">MetaDataRegistry</span>.
      Here's an example:</p>
<pre class="code">&lt;xconf xpath="/cocoon/meta-data"
    unless="/cocoon/meta-data/component-instance
      [@name = 'http://apache.org/lenya/metadata/media/1.0']"&gt;
  &lt;component-instance name="http://apache.org/lenya/metadata/media/1.0"
    class="org.apache.lenya.cms.metadata.ConfigurableElementSet"&gt;
    &lt;element name="filename" multiple="false"/&gt;
    &lt;element name="format" multiple="false"/&gt;
    &lt;element name="extent" multiple="false"/&gt;
    &lt;element name="width" multiple="false"/&gt;
    &lt;element name="height" multiple="false"/&gt;
    &lt;element name="caption" multiple="false" editable="true"/&gt;
  &lt;/component-instance&gt;
&lt;/xconf&gt;</pre>
</div>
    
    
<a name="N10035"></a><a name="Accessing+Meta+Data"></a>
<h2 class="h3">Accessing Meta Data</h2>
<div class="section">
<p>Here's an example for accessing the meta data of a document:</p>
<pre class="code">
MetaData meta = document.getMetaData("http://myproject.org/metadata/1.0");
String description = meta.getFirstValue("description");
String[] references = meta.getValues("references");
</pre>
<p>To find out which element sets are registered, you can access
      the <span class="codefrag">MetaDataRegistry</span>:</p>
<pre class="code">
MetaDataRegistry registry = null;
try {
    registry = (MetaDataRegistry) this.manager.lookup(MetaDataRegistry.ROLE);
    String[] namespaces = registry.getNamespaceUris();
    ...
}
finally {
    if (registry != null) {
        this.manager.release(registry);
    }
}      
</pre>
</div>
    
    
<a name="N1004D"></a><a name="The+Meta+Data+Input+Module"></a>
<h2 class="h3">The Meta Data Input Module</h2>
<div class="section">
<p>You can use the <span class="codefrag">MetaDataModule</span> to make an element set accessible
      in Cocoon sitemaps. To declare it, use a patch file for <span class="codefrag">cocoon.xconf</span>:</p>
<pre class="code">&lt;xconf xpath="/cocoon/input-modules"
  unless="/cocoon/input-modules/component-instance[@name = 'mymeta']"&gt;
  &lt;component-instance logger="sitemap.modules.input.mymeta" name="mymeta"
    class="org.apache.lenya.cms.cocoon.components.modules.input.MetaDataModule"
    namespace="http://myproject.org/metadata/1.0"/&gt;
&lt;/xconf&gt;</pre>
<p>Now you can access the meta data in your pipelines:</p>
<pre class="code">&lt;map:transform src="..."&gt;
  &lt;map:parameter name="description" value="{mymeta:description}"/&gt;
&lt;/map:transform&gt;</pre>
</div>
    
    
<a name="N10068"></a><a name="Storage"></a>
<h2 class="h3">Storage</h2>
<div class="section">
<p>In 1.4.x meta data is stored separately from the document content but in the same 
        directory (index_{lang}.meta).
        A typical sample for a meta data XML document may be the following:
      </p>
<pre class="code">&lt;metadata xmlns="http://apache.org/lenya/metadata/1.0"&gt;
  &lt;element-set namespace="http://apache.org/lenya/metadata/media/1.0"&gt;
    &lt;element key="width"&gt;
      &lt;value&gt;300&lt;/value&gt;
    &lt;/element&gt;
    &lt;element key="height"&gt;
      &lt;value&gt;374&lt;/value&gt;
    &lt;/element&gt;
    &lt;element key="extent"&gt;
      &lt;value&gt;30291&lt;/value&gt;
    &lt;/element&gt;
    &lt;element key="filename"&gt;
      &lt;value&gt;hello-world.jpg&lt;/value&gt;
    &lt;/element&gt;
    &lt;element key="format"&gt;
      &lt;value&gt;image/jpeg&lt;/value&gt;
    &lt;/element&gt;
  &lt;/element-set&gt;
  &lt;element-set namespace="http://purl.org/dc/elements/1.1/"&gt;
    &lt;element key="creator"&gt;
      &lt;value&gt;lenya&lt;/value&gt;
    &lt;/element&gt;
    &lt;element key="title"&gt;
      &lt;value&gt;Hello World&lt;/value&gt;
    &lt;/element&gt;
    &lt;element key="date"&gt;
      &lt;value&gt;2006-07-20 22:44:37&lt;/value&gt;
    &lt;/element&gt;
    &lt;element key="language"&gt;
      &lt;value&gt;en&lt;/value&gt;
    &lt;/element&gt;
  &lt;/element-set&gt;
  &lt;element-set namespace="http://apache.org/lenya/metadata/document/1.0"&gt;
    &lt;element key="extension"&gt;
      &lt;value&gt;jpg&lt;/value&gt;
    &lt;/element&gt;
    &lt;element key="resourceType"&gt;
      &lt;value&gt;resource&lt;/value&gt;
    &lt;/element&gt;
    &lt;element key="contentType"&gt;
      &lt;value&gt;xml&lt;/value&gt;
    &lt;/element&gt;
  &lt;/element-set&gt;
&lt;/metadata&gt;
 </pre>
</div>
    
<a name="N10076"></a><a name="Implementation"></a>
<h2 class="h3">Implementation</h2>
<div class="section">
<p>Like nearly all new modules/functionality the meta data usecases are 
        following the new <strong>fallback</strong> concept. Meaning you are 
        using the core contracts as long you are <strong>not</strong> overriding them with 
        your own implementation. To override a core implementation you just 
        need to place your custom implementation to the right path in you pub 
        and lenya will try to pick it up from there.</p>
<a name="N10085"></a><a name="Create+meta+data"></a>
<h3 class="h4">Create meta data</h3>
<p>Upon creation of a document a set of sample meta data is presented 
          in the creation form. This values are partially filled in by the user 
          (subject, desciption, etc.) and partly by the system (creator, 
          creation data). This is done with the <span class="codefrag">site.create</span> 
          usecase (lenya.usecase=site.create).</p>
<p> To tell lenya that you want as 
          well create a set of custom meta data, you need to extend the
          usecase handler and modify your 
          implementation of the <span class="codefrag">create.jx</span> form.</p>
<div class="note">
<div class="label">Custom implementation of create.jx</div>
<div class="content"> An 
          <strong>example</strong> of an implementation can be found in 
          <span class="codefrag">{$default-pub}/lenya/usecases/site/create.jx</span>. Just 
          change it and see what comes out. BTW if you need it in your custom 
          pub just mind the path. ;-)</div>
</div>
<a name="N100A2"></a><a name="Display%2Fmodify+meta+data"></a>
<h3 class="h4">Display/modify meta data</h3>
<p>The display of meta data is handled by the usecase 
          <span class="codefrag">tab.meta</span>. All editable meta data are presented by the form.</p>
</div>
  
</div>
<!--+
    |end content
    +-->
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<!--+
    |start bottomstrip
    +-->
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2002-2005 <a href="http://www.apache.org/licenses/LICENSE-2.0">The Apache Software Foundation.</a>
</div>
<div id="feedback">
    Send feedback about the website to:
  <a id="feedbackto" href="mailto:dev@lenya.apache.org?subject=Feedback%C2%A0for%C2%A01_4/reference/metadata.html">dev@lenya.apache.org</a>
</div>
<!--+
    |end bottomstrip
    +-->
</div>
</body>
</html>
