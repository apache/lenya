<?xml version="1.0"?>
<!DOCTYPE document PUBLIC "-//APACHE//DTD Documentation V1.1//EN" "document-v11.dtd">
<document> 
  <header> 
    <title>URI Scheme</title>
    <version major="0" minor="2">Version 0.2</version>
    <authors><person name="Christian Egli" email="christian.egli@wyona.org"/>
      <person name="Felix Maeder" email="felix.maeder@wyona.com"/>
    </authors> 
    <abstract>Proposal for a standardization of URIs which are used
      for CMS functionality. </abstract> 
  </header> 
  <body> 

    <section>
      <title>Introduction</title>
      <p>We want to standardize CMS functionality across different
      publications so that we can consolidate them in a standard root
      sitemap.</p>

      <p>In order to achieve this one precondition is to standardize
      on the URIs how the CMS functionality is invoked.</p>

      <p>There are different ways to achieve this. We either reserve
      part of the URI space (e.g. /lenya/foo) or we reserve part of
      the request parameter space (e.g. /foo?lenya=bar)</p>

      <section>
	<title>Dynamic URIs</title>

	<p>We decided to go mostly for the second solution so that we
	  can leave the URI space as required by the publication and use
	  request parameters to invoke CMS actions.</p>

	<p>We define two standard request parameters which we use to
	  invoke all CMS actions in a standard way:</p>
	<dl>
	  <dt><code>lenya.usecase</code></dt>
	  <dd>The name of the use case, e.g. "publish"</dd>
	  <dt><code>lenya.step</code></dt>
	  <dd>Each use case can have multiple steps,
	    e.g. "showscreen"</dd> 
	</dl>
      </section>
      
      <section>
	<title>Static URIs</title>

	<p>There are also some static URIs that are needed for the Lenya
	  CMS. They are mostly internal pipelines for resources such as
	  the menu, css or support files for Xopus and Bitflux
	  editors.</p>

	<p>There is currently no consistent standard as to under which
	  URI space these resources should be located. Some are
	  residing in <code>/xopus/**</code> or
	  <code>/bitflux/**</code> and others are in
	  <code>/lenya/**</code>.</p>
	
      </section>
    </section>

    <section id="uri_definition">
      <title>URI definition</title>
      
      <p>Given the URI
      <code>/lenya/computerworld/authoring/news/foo.html</code> we
      define the following parts:</p>
      <table>
	<tr>
	  <th>URI fragment</th>
	  <th>Name</th>
	</tr>
	<tr>
	  <td>lenya</td>
	  <td><code>context-prefix</code></td>
	</tr>
	<tr>
	  <td>computerworld</td>
	  <td><code>publication-id</code></td>
	</tr>
	<tr>
	  <td>authoring</td>
	  <td><code>area</code></td>
	</tr>
	<tr>
	  <td>news/foo</td>
	  <td><code>document-id</code></td>
	</tr>
      </table>
    </section>

    <section>
      <title>Static URIs</title>

      <p>Currently different fragments of the URI space are reserved
	(e.g. <code>/xopus/**</code>, <code>/bitflux/**</code> and
	everything under <code>/lenya/**</code> that hasn't been
	defined previously).</p>

      <fixme author="ce">The reserved URI space needs to be
      consolidated and standardized.</fixme>
    </section>
    <section>
      <title>Dynamic URIs</title>

      <section>
	<title>Overview of use cases</title>
	<p>The following use cases are known:</p>
	
	<table>
	  <tr>
	    <th>Use case</th>
	    <th><code>lenya.usecase=</code></th>
	    <th><code>lenya.step=</code></th>
	    <th>Comment</th>
	  </tr>
	  <tr>
	    <td>Publish</td>
	    <td>publish</td>
	    <td>showscreen</td>
	    <td>Confirm the publication of this document</td>
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>publish</td>
	    <td>Publish this document</td>
	  </tr>
	  <tr>
	    <td>Create</td>
	    <td>create</td>
	    <td>showscreen</td>
	    <td>Show a form allowing to specify the parameters for
	    creation of a document</td> 
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>create</td>
	    <td>Create the document</td>
	  </tr>
	  <tr>
	    <td>Resource upload</td>
	    <td>upload</td>
	    <td>showscreen</td>
	    <td>Show a form allowing to specify the parameters for
	      uploading of a resource</td>
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>upload</td>
	    <td>Upload the resource</td>
	  </tr>
	  <tr>
	    <td>Rollback</td>
	    <td>rollback</td>
	    <td>showscreen</td>
	    <td>Show a list of all versions of this document</td>
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>view</td>
	    <td>View a particular version of this document</td>
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>rollback</td>
	    <td>Roll back to a particular version of this document</td>
	  </tr>
	  <tr>
	    <td>Checkin</td>
	    <td>checkin</td>
	    <td>showscreen</td>
	    <td>Confirm the checkin of this document</td>
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>checkin</td>
	    <td></td>
	  </tr>
	  <tr>
	    <td>Checkout</td>
	    <td>checkout</td>
	    <td>showscreen</td>
	    <td>Confirm the checkout of this document</td>
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>checkout</td>
	    <td></td>
	  </tr>
	  <tr>
	    <td>Schedule</td>
	    <td>schedule</td>
	    <td>showscreen</td>
	    <td>Show a list of all task scheduled for this document</td>
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>add</td>
	    <td>Add a new task</td>
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>modify</td>
	    <td>Modify an existing task</td>
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>delete</td>
	    <td>Delete an existing task</td>
	  </tr>
	  <tr>
	    <td>Edit</td>
	    <td></td>
	    <td></td>
	  </tr>
	  <tr>
	    <td>User Admin</td>
	    <td>user-admin</td>
	    <td>showscreen</td>
	    <td>Show an overview page listing all users</td>
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>add</td>
	    <td>Add a user</td>
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>modify</td>
	    <td>Modify a user</td>
	  </tr>
	  <tr>
	    <td></td>
	    <td></td>
	    <td>delete</td>
	    <td>Delete a user</td>
	  </tr>
	  <tr>
	    <td>Logout</td>
	    <td>logout</td>
	    <td>showscreen</td>
	    <td>Confirm the logout</td>
	  </tr>
	</table>
	
	<fixme author="ce">Can the authenticate process done in a
	  similar way?</fixme>
	
      </section>
      
      <section>
	<title>Use cases</title>
	
	<section>
	  <title>Resource upload</title>
	  
	  <p><code>lenya.usecase=upload</code></p>
	  
	  <table>
	    <tr>
	      <th><code>lenya.step=</code></th>
	      <th>additional parameters</th>
	      <th>sample value</th>
	    </tr>
	    <tr>
	      <td>showscreen</td>
	      <td>xpath</td>
	      <td>/NewsML/body.content/block[1]/*[1]</td>
	    </tr>
	    <tr>
	      <td></td>
	      <td>insertBefore [optional]</td>
	      <td>true</td>
	    </tr>
	    
	    <tr>
	      <td>upload</td>
	      <td>documentid</td>
	      <td></td>
	    </tr>
	    <tr>
	      <td></td>
	      <td>xpath</td>
	      <td></td>
	    </tr>
	    <tr>
	      <td></td>
	      <td>insertBefore [optional]</td>
	      <td></td>
	    </tr>
	    <tr>
	      <td></td>
	      <td>uploadFile</td>
	      <td></td>
	    </tr>
	    <tr>
	      <td></td>
	      <td>identifier [optional]</td>
	      <td></td>
	    </tr>
	    <tr>
	      <td></td>
	      <td colspan="2">All Dublin core identifiers are also accepted</td>
	    </tr>
	  </table>
	  <fixme author="ce">We assume that we can get the documentid
	    from the request URI (given the standardized <link
	      href="#uri_definition">URI definition</link>). Is this
	    ok?</fixme>
	</section>

	<section>
	  <title>Create</title>

	  <p><code>lenya.usecase=create</code></p>

	  <table>
	    <tr>
	      <th><code>lenya.step=</code></th>
	      <th>additional parameters</th>
	      <th>sample value</th>
	    </tr>
	    <tr>
	      <td>showscreen</td>
	      <td>parentid</td>
	      <td>/dossiers/2003</td>
	    </tr>
	    <tr>
	      <td></td>
	      <td>doctype</td>
	      <td>Dossier</td>
	    </tr>
	    <tr>
	      <td>create</td>
	      <td>parentid</td>
	      <td></td>
	    </tr>
	    <tr>
	      <td></td>
	      <td>childid</td>
	      <td></td>
	    </tr>
	    <tr>
	      <td></td>
	      <td>doctype</td>
	      <td></td>
	    </tr>
	  </table>

	</section>
	
	<section>
	  <title>Rollback</title>

	  <p><code>lenya.usecase=rollback</code></p>

	  <table>
	    <tr>
	      <th><code>lenya.step=</code></th>
	      <th>additional parameters</th>
	      <th>sample value</th>
	    </tr>
	    <tr>
	      <td>showscreen</td>
	      <td></td>
	      <td></td>
	    </tr>
	    <tr>
	      <td>view</td>
	      <td>version</td>
	      <td></td>
	    </tr>
	  </table>
	</section>

	<fixme author="ce">Add remaining use cases</fixme>
      </section>
    </section>
  </body> 
  <footer> 
    <legal>Â© 200 wyona.org</legal> 
  </footer>
</document>
