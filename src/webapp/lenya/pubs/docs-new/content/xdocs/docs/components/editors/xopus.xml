<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE document PUBLIC "-//APACHE//DTD Documentation V1.1//EN" "document-v11.dtd">

<document> 

<header> 
    <title>Xopus</title>
    <version>0.1</version> 
    <type>Documentation</type> 
    <authors>
      <person name="Michael Wechner" email="michi@apache.org"/> 
    </authors> 
</header> 
<body> 

<section>
<title>Demo</title>
<p>Try Xopus at:</p>
<source>
<![CDATA[
http://www.xopus.com/demo/index.html
]]>
</source>
</section>

<section>
<title>Configuration</title>
<p>Lenya needs to know the prefix of Xopus:</p>
<source>
<![CDATA[
src/webapp/lenya/usecase.xmap
src/webapp/lenya/resources/misc/xopus/index.html
]]>
</source>
</section>

<section>
<title>Saving via POST</title>
<p>To enable saving via POST, one needs to modify <code>$XOPUS/xopusPlugins/datadriver.js</code> as follows</p>
<source>
<![CDATA[
    // Save data START
    alert('Save XML via POST');
    var result = Application.sendXML(doc, 'POST', name);

    switch (result.status)
    {
      case 200:
        //OK
        var resultXML = result.responseXML;
        alert('XML saved');
        return;
      case -1:
        alert('Error while saving ' + name + ':\n\n' + result.responseText);
        break;
      default:
        alert('Server responded not ok while saving ' + name + ':\n\nstatus:' + result.status + '\nmessage: ' + resul
t.responseText);
    }
    // Save data END
]]>
</source>
whereas the text of the alerts might be replaced by something else.
</section>

<section>
<title>Exit Xopus</title>
<p>To exit Xopus one needs to modify <code>$XOPUS/xopusPlugins/cmsdriver.js</code> as follows</p>
<source>
<![CDATA[
  getExitURL: function(path)
  {
    exitURL = path.substring(0, path.indexOf('?'));
    alert('Exit to: ' + exitURL)
    return exitURL;
  },
]]>
</source>
whereas the text of the alert might be replaced by something else.
</section>

<section>
<title>Making a page editable with Xopus: Schemas, Views (XSLT) and Menus</title>
<p>Xopus needs an XML Schema for validation and an XSLT to view the document. The Schemas and XSLTs need to be located at:</p>
<source>
<![CDATA[
$PUBLICATION/config/doctypes/schemas/$DOCTYPE.xsd
$PUBLICATION/lenya/xslt/xopus/$DOCTYPE.xsl
]]>
</source>
<p>
whereas one might want to use <link href="http://www.thaiopensource.com/relaxng/trang.html">Trang</link> to generate XML Schemas.
</p>
<p>
Editing with Xopus is implemented as a usecase. One can add a menu item as follows:
</p>
<source>
<![CDATA[
<item uc:usecase="xopus" href="?lenya.step=open&amp;doctype=$DOCTYPE">Edit&#160;with&#160;Xopus</item>
]]>
</source>
</section>
</body>
</document>
