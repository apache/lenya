<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE document PUBLIC "-//APACHE//DTD Documentation V1.1//EN" "document-v11.dtd">

<document> 

<header> 
    <title>Adding a new Document Creator</title>
    <version>0.1</version> 
    <type>Documentation</type> 
    <authors>
      <person name="Michael Wechner" email="michi@apache.org"/> 
    </authors> 
</header> 
<body> 

<section>
<title>Adding a new Menu Item: "New MyDocument"</title>

<p>
The Menubars can be found within the directory <code>config/menus</code>.
Add the "New MyDocument" menu item to the appropriate menubar:
</p>

<source>
<![CDATA[
<menus>
  <menu name="File" label="File">
    <block>
      <item><xsp:attribute name="href">?lenya.usecase=create&amp;lenya.step=showscreen</xsp:attribute>New&#160;MyDocument</item>
    </block>
]]>
</source>

</section>

<section>
<title>Adding usecase "create" to the sitemap</title>

<p>
The pipelines of the usecases are located within <code>usecase.xmap</code>:
</p>

<source>
<![CDATA[
<map:pipeline>
  <map:match pattern="*/*/*/*/*/index.html">
    <map:match type="lenya-usecase" pattern="create">
      <map:match type="lenya-step" pattern="showscreen">
        <map:generate type="serverpages" src="../../content/authoring/parent-child.xsp"/>
        <map:transform src="../../xslt/authoring/parent-child.xsl"/>
        <map:serialize type="html"/>
      </map:match>

      <map:match type="lenya-step" pattern="execute">
        <map:act type="parent-child">
          <map:redirect-to uri="{parent_uri}" session="true"/>
        </map:act>
        <map:redirect-to uri="index.html?lenya.usecase=create&amp;lenya.step=showscreen&amp;status=failed" session="true"/>
      </map:match>
    </map:match>
  </map:match>
</map:pipeline>
]]>
</source>

</section>


<section>
<title>Create <code>doctypes.xconf</code></title>

<p>
The file <code>doctypes.xconf</code> is supposed to be located within the directory <code>config/doctypes</code>.
</p>

<source>
<![CDATA[
<doctypes>
  <doc type="nitf">
    <creator src="org.apache.lenya.cms.authoring.DefaultLeafCreator">
      <sample-name>nitf.xml</sample-name>
    </creator>
  </doc>

  <doc type="xhtml">
    <creator src="org.apache.lenya.cms.authoring.DefaultLeafCreator">
      <sample-name>xhtml.xml</sample-name>
    </creator>
  </doc>
</doctypes>
]]>
</source>

</section>

<section>
<title>Create a sample document</title>

<p>
The sample documents are located within the directory <code>config/doctypes/samples</code>.
</p>

<source>
<![CDATA[
<?xml version="1.0" encoding="ISO-8859-1" ?>
<nitf>
  <head>
    <docdata>
      <doc-id regsrc="nitf_export.pl" id-string="0"/>
      <date.issue norm="20030314T041021Z"/>
      <doc.copyright holder="New OSCOM Times"/>
    </docdata>
    <pubdata position.section="finance" position.sequence="1"/>
  </head>
  <body.head>
    <hedline>
      <hl1>Local OSCOM Sprint @ Zurich, Switzerland</hl1>
]]>
</source>

</section>

</body>
</document>
