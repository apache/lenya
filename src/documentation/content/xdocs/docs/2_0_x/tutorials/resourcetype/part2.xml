<?xml version="1.0" encoding="UTF-8"?>
<!--
  Copyright 1999-2006 The Apache Software Foundation

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!-- $Id: metadata.xml 55543 2004-10-26 00:14:59Z gregor $ -->
<!DOCTYPE document PUBLIC "-//APACHE//DTD Documentation V2.0//EN" 
  "http://forrest.apache.org/dtd/document-v20.dtd">
<document>
  <header>
    <title>Creating a Resource Type, Part 2: Creating Documents</title>
  </header>
  
  <body>

    <section>
      <title>Adding the Menu</title>
      <p>
        Now we'll add the menu for our module. The first item we need will trigger
        the usecase to create new person documents. We have to add a sitemap which
        serves as an entry point for the menu (<code>$MODULE_HOME/menus.xmap)</code>:
      </p>
      <source xml:space="preserve"><![CDATA[<?xml version="1.0"?>
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">
  <map:pipelines>
    <map:pipeline>
      <map:match pattern="**">
        <map:generate type="serverpages"
          src="fallback://lenya/modules/person/config/menu.xsp"/>
        <map:serialize type="xml"/>
      </map:match>
    </map:pipeline>
  </map:pipelines>
</map:sitemap>]]></source>
      <p>
        According to this sitemap, the menu XSP is located at
        <code>$MODULE_HOME/config/menu.xsp</code>:
      </p>
      <source xml:space="preserve"><![CDATA[<?xml version="1.0"?>
<xsp:page 
    language="java" 
    xmlns:xsp="http://apache.org/xsp"
    xmlns:i18n="http://apache.org/cocoon/i18n/2.1"    
    xmlns:uc="http://apache.org/cocoon/lenya/usecase/1.0"
    xmlns="http://apache.org/cocoon/lenya/menubar/1.0">
  <menu>
    <menus>
      <menu i18n:attr="name" name="File">
        <block areas="site authoring">
          <item uc:usecase="sitemanagement.create" href="?doctype=person">
            <i18n:translate>
              <i18n:text>New ... Document</i18n:text>
              <i18n:param>Person</i18n:param>
            </i18n:translate>
          </item>
        </block>
      </menu>
    </menus>
  </menu>
</xsp:page>]]></source>
      <p>
        The menu contains an item which triggers the <code>sitemanagement.create</code>
        usecase with the <code>doctype=person</code> parameter.
      </p>
    </section>
    <section>
      <title>Providing the Sample</title>
      <p>
        To create a document, the <code>sitemanagement.create</code> usecase needs a sample
        XML. We've already specified the sample location in our resource type declaration
        (see above). Now we have to add the corresponding FoaF person file
        (<code>$MODULE_HOME/samples/foaf.xml</code>):
      </p>
      <source xml:space="preserve"><![CDATA[<?xml version="1.0" encoding="UTF-8"?>
<rdf:RDF
  xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
  xmlns:foaf="http://xmlns.com/foaf/0.1/">
  <foaf:Person rdf:ID="me">
    <foaf:title>Mr</foaf:title>
    <foaf:givenname>Homer</foaf:givenname>
    <foaf:family_name>Simpson</foaf:family_name>
    <foaf:mbox rdf:resource="mailto:chunkylover53@aol.com"/>
    <foaf:phone rdf:resource="tel:555-555-555"/>
    <foaf:workplaceHomepage rdf:resource="http://powerplantspringfield.com"/>
  </foaf:Person>
</rdf:RDF>]]></source>

      <p>
        In the <a href="site:newResourceTypePart3">next section</a> we'll render our
        newly created document as an XHTML web page.
      </p>
    </section>
    
  </body>
</document>